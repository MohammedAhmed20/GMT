<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مركز النجاح التعليمي</title>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #7209b7;
            --success-color: #4cc9f0;
            --warning-color: #f72585;
            --text-dark: #2b2d42;
            --text-light: #8d99ae;
            --background-light: #f8f9fa;
            --background-dark: #edf2f4;
            --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .gradient-text {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow);
        }

        .btn-gradient {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            transition: all 0.3s ease;
        }

        .btn-gradient:hover {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-color) 100%);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .input-style {
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .input-style:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
            outline: none;
        }

        .stats-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%);
            backdrop-filter: blur(5px);
        }

        .animated-border {
            position: relative;
            overflow: hidden;
        }

        .animated-border::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .animated-border:hover::after {
            transform: scaleX(1);
        }

        .search-input {
            transition: all 0.3s ease;
        }

        .search-input:focus {
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .expense-card {
            background: linear-gradient(135deg, #f6f8f9 0%, #e5ebee 50%, #d7dee3 100%);
        }
        
        .expense-value {
            font-weight: bold;
            color: var(--primary-color);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback, useMemo, memo, useEffect } = React;

        // المكونات UI المحسنة
        const Card = ({ children, className, ...props }) => (
            <div className={`rounded-xl border bg-white shadow-lg border-0 card-hover ${className}`} {...props}>
                {children}
            </div>
        );

        const CardHeader = ({ children, className, ...props }) => (
            <div className={`p-6 border-b border-gray-100 ${className}`} {...props}>
                {children}
            </div>
        );

        const CardTitle = ({ children, className, ...props }) => (
            <h3 className={`text-xl font-bold gradient-text ${className}`} {...props}>
                {children}
            </h3>
        );

        const CardDescription = ({ children, className, ...props }) => (
            <p className={`text-sm text-gray-500 ${className}`} {...props}>
                {children}
            </p>
        );

        const CardContent = ({ children, className, ...props }) => (
            <div className={`p-6 pt-0 ${className}`} {...props}>
                {children}
            </div>
        );

        const CardFooter = ({ children, className, ...props }) => (
            <div className={`flex items-center p-6 pt-0 border-t border-gray-100 ${className}`} {...props}>
                {children}
            </div>
        );

        const Button = ({ children, className, onClick, ...props }) => (
            <button 
                className={`px-5 py-2.5 rounded-lg font-medium transition-all duration-300 btn-gradient text-white ${className}`} 
                onClick={onClick}
                {...props}
            >
                {children}
            </button>
        );

        const Input = ({ value, onChange, placeholder, className, ...props }) => (
            <input
                type="text"
                value={value}
                onChange={onChange}
                className={`flex h-11 w-full rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm focus:outline-none input-style ${className}`}
                placeholder={placeholder}
                {...props}
            />
        );

        const Label = ({ htmlFor, children, className, ...props }) => (
            <label 
                htmlFor={htmlFor} 
                className={`text-sm font-medium text-gray-700 ${className}`} 
                {...props}
            >
                {children}
            </label>
        );

        const Alert = ({ children, className, ...props }) => (
            <div className={`bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg mb-4 ${className}`} {...props}>
                {children}
            </div>
        );

        const AlertDescription = ({ children, className, ...props }) => (
            <p className={`text-sm ${className}`} {...props}>
                {children}
            </p>
        );

        /**
         * مكون Dashboard - يعرض الإحصائيات الرئيسية للمركز
         */
        const Dashboard = memo(({ stats }) => {
          return (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
              <Card className="stats-card">
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">إجمالي الطلاب</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-4xl font-bold text-blue-600">{stats.totalStudents}</div>
                  <p className="text-sm text-gray-500">+{stats.newStudentsThisWeek} هذا الأسبوع</p>
                </CardContent>
              </Card>

              <Card className="stats-card">
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">المواد الدراسية</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-4xl font-bold text-green-600">{stats.totalSubjects}</div>
                  <p className="text-sm text-gray-500">جميع المواد نشطة</p>
                </CardContent>
              </Card>

              <Card className="stats-card">
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">نسبة الحضور</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-4xl font-bold text-orange-600">{stats.attendancePercentage}%</div>
                  <p className="text-sm text-gray-500">+{stats.attendanceChangePercentage}% عن الأسبوع الماضي</p>
                </CardContent>
              </Card>

              <Card className="stats-card">
                <CardHeader className="pb-2">
                  <CardTitle className="text-lg">المتوسط العام</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-4xl font-bold text-purple-600">{stats.averageScore}%</div>
                  <p className="text-sm text-gray-500">+{stats.averageScoreChangePercentage}% عن الفصل الماضي</p>
                </CardContent>
              </Card>
            </div>
          );
        });

        /**
         * مكون StudentForm - نموذج إضافة طالب جديد
         * @param {Object} props
         * @param {Object} props.newStudent - بيانات الطالب الجديد
         * @param {Function} props.setNewStudent - دالة لتحديث بيانات الطالب
         * @param {Function} props.addStudent - دالة لإضافة طالب
         * @param {Object} props.error - معلومات الخطأ (إن وجدت)
         * @param {boolean} props.isEditing - هل نم في وضع التعديل؟
         */
        const StudentForm = memo(({ newStudent, setNewStudent, addStudent, error, isEditing }) => {
          return (
            <Card className="animated-border">
              <CardHeader>
                <CardTitle>{isEditing ? 'تعديل بيانات طالب' : 'إضافة طالب جديد'}</CardTitle>
                <CardDescription>أدخل معلومات {isEditing ? 'الطالب المعدل' : 'الطالب الجديد'}</CardDescription>
              </CardHeader>
              <CardContent className="space-y-6">
                {error && (
                  <Alert>
                    <AlertDescription>{error.message}</AlertDescription>
                  </Alert>
                )}
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="name">اسم الطالب</Label>
                    <Input
                      id="name"
                      value={newStudent.name}
                      onChange={(e) => setNewStudent({ ...newStudent, name: e.target.value })}
                      placeholder="أدخل اسم الطالب"
                      className={error?.field === 'name' ? 'border-red-500' : ''}
                    />
                    {error?.field === 'name' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="grade">الصف الدراسي</Label>
                    <Input
                      id="grade"
                      value={newStudent.grade}
                      onChange={(e) => setNewStudent({ ...newStudent, grade: e.target.value })}
                      placeholder="أدخل الصف الدراسي"
                      className={error?.field === 'grade' ? 'border-red-500' : ''}
                    />
                    {error?.field === 'grade' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="phone">رقم الهاتف</Label>
                    <Input
                      id="phone"
                      value={newStudent.phone}
                      onChange={(e) => setNewStudent({ ...newStudent, phone: e.target.value })}
                      placeholder="أدخل رقم الهاتف"
                      className={error?.field === 'phone' ? 'border-red-500' : ''}
                    />
                    {error?.field === 'phone' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="subjects">المواد الدراسية</Label>
                    <Input
                      id="subjects"
                      placeholder="أدخل المواد (مفصولة بفاصلة)"
                      onChange={(e) => setNewStudent({ ...newStudent, subjects: e.target.value.split(',').map(s => s.trim()) })}
                      className={error?.field === 'subjects' ? 'border-red-500' : ''}
                      value={newStudent.subjects.join(', ')}
                    />
                    {error?.field === 'subjects' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="totalExpense">المصروفات الإجمالية</Label>
                    <Input
                      id="totalExpense"
                      type="number"
                      value={newStudent.totalExpense || ''}
                      onChange={(e) => setNewStudent({ ...newStudent, totalExpense: parseFloat(e.target.value) || 0 })}
                      placeholder="أدخل المصروفات الإجمالية"
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="paidAmount">المدفوع</Label>
                    <Input
                      id="paidAmount"
                      type="number"
                      value={newStudent.paidAmount || ''}
                      onChange={(e) => setNewStudent({ ...newStudent, paidAmount: parseFloat(e.target.value) || 0 })}
                      placeholder="أدخل المبلغ المدفوع"
                    />
                  </div>
                </div>
              </CardContent>
              <CardFooter>
                <Button 
                  onClick={addStudent} 
                  className="w-full justify-center"
                >
                  <i className={`fas fa-${isEditing ? 'edit' : 'user-plus'} mr-2`}></i>
                  {isEditing ? 'تحديث البيانات' : 'إضافة طالب'}
                </Button>
              </CardFooter>
            </Card>
          );
        });

        /**
         * مكون StudentList - قائمة الطلاب المسجلين
         * @param {Object} props
         * @param {Array} props.students - قائمة الطلاب
         * @param {Function} props.onEditStudent - دالة لتعديل بيانات طالب
         * @param {Function} props.onDeleteStudent - دالة لحذف طالب
         * @param {string} props.searchTerm - مصطلح البحث
         * @param {Function} props.setSearchTerm - دالة لتحديث مصطلح البحث
         */
        const StudentList = memo(({ students, onEditStudent, onDeleteStudent, searchTerm, setSearchTerm }) => {
          const filteredStudents = students.filter(student => 
            student.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            student.grade.toLowerCase().includes(searchTerm.toLowerCase()) ||
            student.subjects.some(subject => subject.toLowerCase().includes(searchTerm.toLowerCase()))
          );

          return (
            <Card className="animated-border">
              <CardHeader>
                <div className="flex justify-between items-center">
                  <div>
                    <CardTitle>قائمة الطلاب</CardTitle>
                    <CardDescription>جميع الطلاب المسجلين في المركز</CardDescription>
                  </div>
                  <div className="w-full md:w-64">
                    <Input
                      placeholder="بحث عن طالب..."
                      className="search-input"
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                    />
                  </div>
                </div>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  {filteredStudents.length === 0 ? (
                    <div className="text-center py-10">
                      <i className="fas fa-users text-5xl text-gray-300 mb-4"></i>
                      <p className="text-gray-500">لا يوجد طلاب مطابقين للبحث</p>
                    </div>
                  ) : (
                    filteredStudents.map((student) => (
                      <div key={student.id} className="flex items-center justify-between p-5 border rounded-lg hover:bg-gray-50 transition-colors">
                        <div className="flex items-center space-x-5">
                          <div className="flex-shrink-0">
                            <div className="w-14 h-14 rounded-full bg-blue-100 flex items-center justify-center">
                              <i className="fas fa-user-graduate text-2xl text-blue-600"></i>
                            </div>
                          </div>
                          <div className="space-y-1">
                            <h4 className="font-semibold text-lg">{student.name}</h4>
                            <p className="text-sm text-gray-500">{student.grade}</p>
                            <div className="flex space-x-4 text-xs">
                              <span className="text-blue-600">
                                <i className="fas fa-wallet mr-1"></i> 
                                مصروفات: <span className="expense-value">{student.totalExpense}</span> ج.م
                              </span>
                              <span className="text-green-600">
                                <i className="fas fa-money-bill-wave mr-1"></i> 
                                مدفوع: <span className="expense-value">{student.paidAmount}</span> ج.م
                              </span>
                              <span className="text-red-600">
                                <i className="fas fa-balance-scale mr-1"></i> 
                                remaining: <span className="expense-value">{student.totalExpense - student.paidAmount}</span> ج.م
                              </span>
                            </div>
                          </div>
                        </div>
                        <div className="flex items-center space-x-4">
                          <div className="text-right">
                            <p className="text-sm"><i className="fas fa-phone-alt text-gray-400 mr-1"></i> {student.phone}</p>
                            <p className="text-xs text-gray-500 mt-1">
                              <i className="fas fa-book text-gray-400 mr-1"></i> {student.subjects.join('، ')}
                            </p>
                          </div>
                          <div className="flex space-x-2">
                            <Button 
                              onClick={() => onEditStudent(student)}
                              className="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm"
                            >
                              <i className="fas fa-edit"></i>
                            </Button>
                            <Button 
                              onClick={() => onDeleteStudent(student.id)}
                              className="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm"
                            >
                              <i className="fas fa-trash-alt"></i>
                            </Button>
                          </div>
                        </div>
                      </div>
                    ))
                  )}
                </div>
              </CardContent>
            </Card>
          );
        });

        /**
         * مكون SubjectForm - نموذج إضافة مادة جديدة
         * @param {Object} props
         * @param {Object} props.newSubject - بيانات المادة الجديدة
         * @param {Function} props.setNewSubject - دالة لتحديث بيانات المادة
         * @param {Function} props.addSubject - دالة لإضافة مادة
         * @param {Object} props.error - معلومات الخطأ (إن وجدت)
         * @param {boolean} props.isEditing - هل نم في وضع التعديل؟
         */
        const SubjectForm = memo(({ newSubject, setNewSubject, addSubject, error, isEditing }) => {
          return (
            <Card className="animated-border">
              <CardHeader>
                <CardTitle>{isEditing ? 'تعديل بيانات مادة' : 'إضافة مادة جديدة'}</CardTitle>
                <CardDescription>أدخل معلومات {isEditing ? 'المادة المعدلة' : 'المادة الجديدة'}</CardDescription>
              </CardHeader>
              <CardContent className="space-y-6">
                {error && (
                  <Alert>
                    <AlertDescription>{error.message}</AlertDescription>
                  </Alert>
                )}
                
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <Label htmlFor="subjectName">اسم المادة</Label>
                    <Input
                      id="subjectName"
                      value={newSubject.name}
                      onChange={(e) => setNewSubject({ ...newSubject, name: e.target.value })}
                      placeholder="أدخل اسم المادة"
                      className={error?.field === 'name' ? 'border-red-500' : ''}
                    />
                    {error?.field === 'name' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="teacher">اسم المدرس</Label>
                    <Input
                      id="teacher"
                      value={newSubject.teacher}
                      onChange={(e) => setNewSubject({ ...newSubject, teacher: e.target.value })}
                      placeholder="أدخل اسم المدرس"
                      className={error?.field === 'teacher' ? 'border-red-500' : ''}
                    />
                    {error?.field === 'teacher' && (
                      <p className="text-red-500 text-xs mt-1">{error.message}</p>
                    )}
                  </div>
                </div>
                <div className="space-y-2">
                  <Label htmlFor="schedule">مواعيد الحصص</Label>
                  <Input
                    id="schedule"
                    value={newSubject.schedule}
                    onChange={(e) => setNewSubject({ ...newSubject, schedule: e.target.value })}
                    placeholder="أدخل مواعيد الحصص"
                    className={error?.field === 'schedule' ? 'border-red-500' : ''}
                  />
                  {error?.field === 'schedule' && (
                    <p className="text-red-500 text-xs mt-1">{error.message}</p>
                  )}
                </div>
              </CardContent>
              <CardFooter>
                <Button 
                  onClick={addSubject} 
                  className="w-full justify-center"
                >
                  <i className={`fas fa-${isEditing ? 'edit' : 'plus'} mr-2`}></i>
                  {isEditing ? 'تحديث المادة' : 'إضافة مادة'}
                </Button>
              </CardFooter>
            </Card>
          );
        });

        /**
         * مكون SubjectList - قائمة المواد الدراسية
         * @param {Object} props
         * @param {Array} props.subjects - قائمة المواد
         * @param {Function} props.onEditSubject - دالة لتعديل بيانات مادة
         * @param {Function} props.onDeleteSubject - دالة لحذف مادة
         */
        const SubjectList = memo(({ subjects, onEditSubject, onDeleteSubject }) => {
          return (
            <Card className="animated-border">
              <CardHeader>
                <CardTitle>قائمة المواد الدراسية</CardTitle>
                <CardDescription>جميع المواد المقدمة في المركز</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  {subjects.length === 0 ? (
                    <div className="text-center py-10 col-span-3">
                      <i className="fas fa-book-open text-5xl text-gray-300 mb-4"></i>
                      <p className="text-gray-500">لا يوجد مواد مسجلة بعد</p>
                    </div>
                  ) : (
                    subjects.map((subject) => (
                      <Card key={subject.id} className="bg-blue-50 border-blue-200 hover:shadow-md transition-shadow">
                        <CardHeader className="pb-3">
                          <div className="flex justify-between items-start">
                            <div>
                              <CardTitle className="text-lg text-blue-800">{subject.name}</CardTitle>
                              <CardDescription className="text-blue-600">مدرس: {subject.teacher}</CardDescription>
                            </div>
                            <div className="flex space-x-2">
                              <Button 
                                onClick={() => onEditSubject(subject)}
                                className="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-lg text-sm"
                              >
                                <i className="fas fa-edit"></i>
                              </Button>
                              <Button 
                                onClick={() => onDeleteSubject(subject.id)}
                                className="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-lg text-sm"
                              >
                                <i className="fas fa-trash-alt"></i>
                              </Button>
                            </div>
                          </div>
                        </CardHeader>
                        <CardContent>
                          <p className="text-sm text-blue-600 flex items-center">
                            <i className="fas fa-calendar-alt text-blue-400 mr-2"></i>
                            {subject.schedule}
                          </p>
                        </CardContent>
                      </Card>
                    ))
                  )}
                </div>
              </CardContent>
            </Card>
          );
        });

        /**
         * مكون AttendanceManager - إدارة حضور الطلاب
         * @param {Object} props
         * @param {Array} props.students - قائمة الطلاب
         * @param {Function} props.onSave - دالة لحفظ بيانات الحضور
         */
        const AttendanceManager = memo(({ students, onSave }) => {
          // استخدام useMemo لتخزين جدول الحضور وتجنب إعادة الحساب عند كل render
          const attendanceTable = React.useMemo(() => {
            return students.map(student => ({
              id: student.id,
              name: student.name,
              status: 'present',
              notes: ''
            }));
          }, [students]);

          return (
            <Card className="animated-border">
              <CardHeader>
                <CardTitle>سجل الحضور والغياب</CardTitle>
                <CardDescription>إدارة حضور الطلاب اليومي</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="overflow-x-auto">
                  <table className="w-full text-right">
                    <thead>
                      <tr className="bg-gray-100">
                        <th className="p-4">اسم الطالب</th>
                        <th className="p-4">اليوم</th>
                        <th className="p-4">الحضور</th>
                        <th className="p-4">ملاحظات</th>
                      </tr>
                    </thead>
                    <tbody>
                      {students.map((student) => (
                        <tr key={student.id} className="border-b hover:bg-gray-50">
                          <td className="p-4">{student.name}</td>
                          <td className="p-4">{new Date().toLocaleDateString('ar-SA')}</td>
                          <td className="p-4">
                            <select className="border rounded p-2 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                              <option value="present">حاضر</option>
                              <option value="absent">غائب</option>
                              <option value="late">متأخر</option>
                            </select>
                          </td>
                          <td className="p-4">
                            <Input placeholder="أدخل الملاحظات" className="text-sm" />
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </CardContent>
              <CardFooter>
                <Button onClick={onSave} className="bg-blue-600 hover:bg-blue-700 text-white">
                  <i className="fas fa-save mr-2"></i>
                  حفظ الحضور
                </Button>
              </CardFooter>
            </Card>
          );
        });

        /**
         * مكون ResultsManager - إدارة نتائج الطلاب
         * @param {Object} props
         * @param {Array} props.students - قائمة الطلاب
         * @param {Array} props.subjects - قائمة المواد
         * @param {Function} props.onSave - دالة لحفظ النتيجة
         */
        const ResultsManager = memo(({ students, subjects, onSave }) => {
          const [selectedStudentId, setSelectedStudentId] = useState('');
          const [selectedSubjectId, setSelectedSubjectId] = useState('');
          const [score, setScore] = useState('');

          return (
            <Card className="animated-border">
              <CardHeader>
                <CardTitle>إدارة النتائج</CardTitle>
                <CardDescription>تسجيل وعرض نتائج الطلاب</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="space-y-6">
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div className="space-y-2">
                      <Label htmlFor="studentSelect">اختر الطالب</Label>
                      <select 
                        id="studentSelect" 
                        className="w-full border rounded-lg p-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        value={selectedStudentId}
                        onChange={(e) => setSelectedStudentId(e.target.value)}
                      >
                        <option value="">اختر طالب</option>
                        {students.map((student) => (
                          <option key={student.id} value={student.id}>
                            {student.name}
                          </option>
                        ))}
                      </select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="subjectSelect">اختر المادة</Label>
                      <select 
                        id="subjectSelect" 
                        className="w-full border rounded-lg p-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        value={selectedSubjectId}
                        onChange={(e) => setSelectedSubjectId(e.target.value)}
                      >
                        <option value="">اختر مادة</option>
                        {subjects.map((subject) => (
                          <option key={subject.id} value={subject.id}>
                            {subject.name}
                          </option>
                        ))}
                      </select>
                    </div>
                    <div className="space-y-2">
                      <Label htmlFor="score">الدرجة</Label>
                      <Input 
                        id="score" 
                        type="number" 
                        placeholder="أدخل الدرجة" 
                        value={score}
                        onChange={(e) => setScore(e.target.value)}
                      />
                    </div>
                  </div>
                  <Button 
                    onClick={onSave} 
                    className="w-full justify-center"
                    disabled={!selectedStudentId || !selectedSubjectId || !score}
                  >
                    <i className="fas fa-graduation-cap mr-2"></i>
                    حفظ النتيجة
                  </Button>
                </div>
              </CardContent>
            </Card>
          );
        });

        /**
         * مكون ReportsManager - إدارة التقارير
         */
        const ReportsManager = memo(() => {
          return (
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <Card className="animated-border">
                <CardHeader>
                  <CardTitle>تقارير الأداء</CardTitle>
                  <CardDescription>تقارير أداء الطلاب والإحصائيات</CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-4">
                    <Button variant="outline" className="w-full justify-start">
                      <i className="fas fa-chart-line mr-2"></i>
                      تقرير الحضور الشهري
                    </Button>
                    <Button variant="outline" className="w-full justify-start">
                      <i className="fas fa-chart-bar mr-2"></i>
                      تقرير النتائج الفصلية
                    </Button>
                    <Button variant="outline" className="w-full justify-start">
                      <i className="fas fa-chart-pie mr-2"></i>
                      إحصائيات الطلاب
                    </Button>
                    <Button variant="outline" className="w-full justify-start">
                      <i className="fas fa-chalkboard-teacher mr-2"></i>
                      تقرير المدرسين
                    </Button>
                  </div>
                </CardContent>
              </Card>

              <Card className="animated-border">
                <CardHeader>
                  <CardTitle>الإحصائيات</CardTitle>
                  <CardDescription>نظرة عامة على إحصائيات المركز</CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-4">
                    <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                      <span>عدد الطلاب الكلي</span>
                      <span className="font-bold">128</span>
                    </div>
                    <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                      <span>متوسط الحضور</span>
                      <span className="font-bold text-green-600">94%</span>
                    </div>
                    <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                      <span>المتوسط العام</span>
                      <span className="font-bold text-blue-600">86%</span>
                    </div>
                    <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                      <span>الطلاب الجدد هذا الشهر</span>
                      <span className="font-bold text-orange-600">15</span>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </div>
          );
        });

        /**
         * المكون الرئيسي - EducationCenterApp
         * تطبيق لإدارة مركز تعليمي
         */
        const EducationCenterApp = () => {
          // الحالة الرئيسية للتطبيق
          const [activeTab, setActiveTab] = useState('dashboard');
          const [students, setStudents] = useState([
            { id: 1, name: 'أحمد محمد', grade: 'الصف الأول الثانوي', phone: '0123456789', subjects: ['رياضيات', 'فيزياء'], totalExpense: 5000, paidAmount: 3000 },
            { id: 2, name: 'سارة علي', grade: 'الصف الثاني الثانوي', phone: '0123456790', subjects: ['كيمياء', 'أحياء'], totalExpense: 4500, paidAmount: 4500 },
            { id: 3, name: 'محمد أحمد', grade: 'الصف الثالث الثانوي', phone: '0123456791', subjects: ['لغة عربية', 'لغة إنجليزية'], totalExpense: 6000, paidAmount: 4000 },
            // إضافة المزيد من الطلاب للاختبار
            ...Array(20).fill().map((_, i) => ({
              id: i + 4,
              name: `طالب ${i + 4}`,
              grade: `الصف ${Math.floor(Math.random() * 3) + 1} الثانوي`,
              phone: `01234567${80 + i}`,
              subjects: ['رياضيات', 'فيزياء', 'كيمياء'].slice(0, Math.floor(Math.random() * 3) + 1),
              totalExpense: 4000 + Math.random() * 3000,
              paidAmount: 2000 + Math.random() * 4000
            }))
          ]);

          const [subjects, setSubjects] = useState([
            { id: 1, name: 'رياضيات', teacher: 'د. مصطفى', schedule: 'السبت والإثنين 4-6 مساءً' },
            { id: 2, name: 'فيزياء', teacher: 'أ. أحمد', schedule: 'الأحد والثلاثاء 5-7 مساءً' },
            { id: 3, name: 'كيمياء', teacher: 'د. سامية', schedule: 'الإثنين والأربعاء 3-5 مساءً' },
            // إضافة المزيد من المواد للاختبار
            ...Array(10).fill().map((_, i) => ({
              id: i + 4,
              name: `مادة ${i + 4}`,
              teacher: `مدرس ${i + 4}`,
              schedule: `السبت والأحد ${i + 1}-${i + 3} مساءً`
            }))
          ]);

          const [newStudent, setNewStudent] = useState({ name: '', grade: '', phone: '', subjects: [], totalExpense: 0, paidAmount: 0 });
          const [newSubject, setNewSubject] = useState({ name: '', teacher: '', schedule: '' });
          const [error, setError] = useState(null);
          const [successMessage, setSuccessMessage] = useState('');
          const [isEditing, setIsEditing] = useState(false);
          const [editingStudentId, setEditingStudentId] = useState(null);
          const [isEditingSubject, setIsEditingSubject] = useState(false);
          const [editingSubjectId, setEditingSubjectId] = useState(null);
          const [searchTerm, setSearchTerm] = useState('');

          // تأثيرات التحويم للأزرار والأيقونات
          useEffect(() => {
            // إضافة تأثير hover للأزرار
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
              button.addEventListener('mouseenter', () => {
                button.style.transform = 'translateY(-2px)';
              });
              button.addEventListener('mouseleave', () => {
                button.style.transform = 'translateY(0)';
              });
            });
          }, []);

          // التحقق من صحة بيانات الطالب
          const validateStudent = useCallback((student) => {
            if (!student.name.trim()) {
              return { isValid: false, field: 'name', message: 'اسم الطالب مطلوب' };
            }
            if (!student.grade.trim()) {
              return { isValid: false, field: 'grade', message: 'الصف الدراسي مطلوب' };
            }
            if (student.phone && !/^\d{10}$/.test(student.phone)) {
              return { isValid: false, field: 'phone', message: 'رقم الهاتف يجب أن يتكون من 10 أرقام' };
            }
            if (student.subjects.length === 0) {
              return { isValid: false, field: 'subjects', message: 'يجب تحديد至少 مادة واحدة' };
            }
            return { isValid: true };
          }, []);

          // التحقق من صحة بيانات المادة
          const validateSubject = useCallback((subject) => {
            if (!subject.name.trim()) {
              return { isValid: false, field: 'name', message: 'اسم المادة مطلوب' };
            }
            if (!subject.teacher.trim()) {
              return { isValid: false, field: 'teacher', message: 'اسم المدرس مطلوب' };
            }
            if (!subject.schedule.trim()) {
              return { isValid: false, field: 'schedule', message: 'مواعيد الحصص مطلوبة' };
            }
            return { isValid: true };
          }, []);

          // دالة حذف طالب
          const deleteStudent = useCallback((id) => {
            setStudents(prev => prev.filter(student => student.id !== id));
            setSuccessMessage('تم حذف الطالب بنجاح');
            setTimeout(() => setSuccessMessage(''), 3000);
          }, []);

          // دالة حذف مادة
          const deleteSubject = useCallback((id) => {
            setSubjects(prev => prev.filter(subject => subject.id !== id));
            setSuccessMessage('تم حذف المادة بنجاح');
            setTimeout(() => setSuccessMessage(''), 3000);
          }, []);

          // دالة تعديل بيانات طالب
          const handleEditStudent = useCallback((student) => {
            setNewStudent({
              name: student.name,
              grade: student.grade,
              phone: student.phone,
              subjects: student.subjects,
              totalExpense: student.totalExpense,
              paidAmount: student.paidAmount
            });
            setIsEditing(true);
            setEditingStudentId(student.id);
            setActiveTab('students');
          }, []);

          // دالة تعديل بيانات مادة
          const handleEditSubject = useCallback((subject) => {
            setNewSubject({
              name: subject.name,
              teacher: subject.teacher,
              schedule: subject.schedule
            });
            setIsEditingSubject(true);
            setEditingSubjectId(subject.id);
            setActiveTab('subjects');
          }, []);

          // إضافة/تحديث طالب مع التحقق من صحة البيانات
          const addStudent = useCallback(() => {
            const validation = validateStudent(newStudent);
            if (!validation.isValid) {
              setError(validation);
              return;
            }
            
            setError(null);
            if (isEditing) {
              // تحديث بيانات طالب موجود
              setStudents(prev => prev.map(student => 
                student.id === editingStudentId 
                  ? { ...newStudent, id: editingStudentId } 
                  : student
              ));
              setSuccessMessage('تم تحديث بيانات الطالب بنجاح');
              setIsEditing(false);
              setEditingStudentId(null);
            } else {
              // إضافة طالب جديد
              setStudents(prev => [...prev, { ...newStudent, id: prev.length + 1 }]);
              setSuccessMessage('تم إضافة الطالب بنجاح');
            }
            
            setNewStudent({ name: '', grade: '', phone: '', subjects: [], totalExpense: 0, paidAmount: 0 });
            setTimeout(() => setSuccessMessage(''), 3000);
          }, [newStudent, validateStudent, isEditing, editingStudentId]);

          // إضافة/تحديث مادة مع التحقق من صحة البيانات
          const addSubject = useCallback(() => {
            const validation = validateSubject(newSubject);
            if (!validation.isValid) {
              setError(validation);
              return;
            }
            
            setError(null);
            if (isEditingSubject) {
              // تحديث بيانات مادة موجودة
              setSubjects(prev => prev.map(subject => 
                subject.id === editingSubjectId 
                  ? { ...newSubject, id: editingSubjectId } 
                  : subject
              ));
              setSuccessMessage('تم تحديث بيانات المادة بنجاح');
              setIsEditingSubject(false);
              setEditingSubjectId(null);
            } else {
              // إضافة مادة جديدة
              setSubjects(prev => [...prev, { ...newSubject, id: prev.length + 1 }]);
              setSuccessMessage('تم إضافة المادة بنجاح');
            }
            
            setNewSubject({ name: '', teacher: '', schedule: '' });
            setTimeout(() => setSuccessMessage(''), 3000);
          }, [newSubject, validateSubject, isEditingSubject, editingSubjectId]);

          // حفظ بيانات الحضور
          const saveAttendance = useCallback(() => {
            setSuccessMessage('تم حفظ بيانات الحضور بنجاح');
            setTimeout(() => setSuccessMessage(''), 3000);
          }, []);

          // حفظ بيانات النتائج
          const saveResult = useCallback(() => {
            setSuccessMessage('تم حفظ النتيجة بنجاح');
            setTimeout(() => setSuccessMessage(''), 3000);
          }, []);

          // إحصائيات لوحة التحكم
          const dashboardStats = useMemo(() => ({
            totalStudents: students.length,
            newStudentsThisWeek: 5,
            attendancePercentage: 94,
            attendanceChangePercentage: 2,
            averageScore: 86,
            averageScoreChangePercentage: 3,
            totalSubjects: subjects.length
          }), [students.length, subjects.length]);

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
              {/* Header */}
              <header className="bg-white shadow-lg">
                <div className="container mx-auto px-6 py-4">
                  <div className="flex justify-between items-center">
                    <div className="flex items-center space-x-4">
                      <div className="w-12 h-12 rounded-lg bg-gradient-to-br from-blue-600 to-indigo-700 flex items-center justify-center">
                        <i className="fas fa-graduation-cap text-2xl text-white"></i>
                      </div>
                      <h1 className="text-2xl font-bold gradient-text">سنتر الشروق</h1>
                    </div>
                    <div className="flex items-center space-x-4">
                      <div className="text-right">
                        <p className="text-sm text-gray-600 font-medium">مرحباً، مدير المركز</p>
                        <p className="text-xs text-gray-500">آخر دخول: اليوم 10:30 ص</p>
                      </div>
                      <div className="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                        <i className="fas fa-user-cog text-blue-600"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </header>

              {/* Navigation */}
              <nav className="bg-white shadow-md sticky top-0 z-50">
                <div className="container mx-auto px-6">
                  <div className="flex space-x-3 py-4 overflow-x-auto">
                    {['dashboard', 'students', 'subjects', 'attendance', 'results', 'reports'].map((tab) => (
                      <button
                        key={tab}
                        onClick={() => setActiveTab(tab)}
                        className={`px-5 py-2.5 rounded-lg font-medium transition-all duration-300 flex items-center space-x-2 ${
                          activeTab === tab
                            ? 'bg-blue-600 text-white shadow-md'
                            : 'text-gray-600 hover:bg-blue-50 hover:text-blue-700'
                        }`}
                      >
                        <i className={`fas fa-${getTabIcon(tab)} ${activeTab === tab ? 'text-white' : 'text-gray-500'}`}></i>
                        <span>{getTabLabel(tab)}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </nav>

              {/* Success Message */}
              {successMessage && (
                <div className="container mx-auto px-6 py-4">
                  <Alert>
                    <AlertDescription className="text-blue-700 font-medium">{successMessage}</AlertDescription>
                  </Alert>
                </div>
              )}

              {/* Main Content */}
              <main className="container mx-auto px-6 py-8">
                {/* Dashboard */}
                {activeTab === 'dashboard' && <Dashboard stats={dashboardStats} />}

                {/* Students Management */}
                {activeTab === 'students' && (
                  <div className="space-y-6">
                    <StudentForm 
                      newStudent={newStudent} 
                      setNewStudent={setNewStudent} 
                      addStudent={addStudent}
                      error={error}
                      isEditing={isEditing}
                    />
                    <StudentList 
                      students={students} 
                      onEditStudent={handleEditStudent}
                      onDeleteStudent={deleteStudent}
                      searchTerm={searchTerm}
                      setSearchTerm={setSearchTerm}
                    />
                  </div>
                )}

                {/* Subjects Management */}
                {activeTab === 'subjects' && (
                  <div className="space-y-6">
                    <SubjectForm 
                      newSubject={newSubject} 
                      setNewSubject={setNewSubject} 
                      addSubject={addSubject}
                      error={error}
                      isEditing={isEditingSubject}
                    />
                    <SubjectList 
                      subjects={subjects} 
                      onEditSubject={handleEditSubject}
                      onDeleteSubject={deleteSubject}
                    />
                  </div>
                )}

                {/* Attendance */}
                {activeTab === 'attendance' && (
                  <AttendanceManager 
                    students={students} 
                    onSave={saveAttendance}
                  />
                )}

                {/* Results */}
                {activeTab === 'results' && (
                  <ResultsManager 
                    students={students} 
                    subjects={subjects}
                    onSave={saveResult}
                  />
                )}

                {/* Reports */}
                {activeTab === 'reports' && <ReportsManager />}
              </main>

              {/* Footer */}
              <footer className="bg-white border-t mt-8">
                <div className="container mx-auto px-6 py-4">
                  <div className="flex justify-between items-center">
                    <p className="text-sm text-gray-600">
                      © 2024 سنتر الشروق. جميع الحقوق محفوظة.
                    </p>
                    <div className="flex space-x-4">
                      <Button variant="ghost" size="sm" className="text-gray-600 hover:text-blue-600">
                        <i className="fas fa-file-contract mr-1"></i> الشروط والأحكام
                      </Button>
                      <Button variant="ghost" size="sm" className="text-gray-600 hover:text-blue-600">
                        <i className="fas fa-user-shield mr-1"></i> سياسة الخصوصية
                      </Button>
                      <Button variant="ghost" size="sm" className="text-gray-600 hover:text-blue-600">
                        <i className="fas fa-headset mr-1"></i> الدعم الفني
                      </Button>
                    </div>
                  </div>
                </div>
              </footer>
            </div>
          );
        };

        // دالة للحصول على أيقونة التبويب
        const getTabIcon = (tab) => {
          switch(tab) {
            case 'dashboard': return 'tachometer-alt';
            case 'students': return 'users';
            case 'subjects': return 'book';
            case 'attendance': return 'clipboard-check';
            case 'results': return 'chart-line';
            case 'reports': return 'file-invoice';
            default: return 'circle';
          }
        };

        // دالة للحصول على تسمية التبويب
        const getTabLabel = (tab) => {
          switch(tab) {
            case 'dashboard': return 'لوحة التحكم';
            case 'students': return 'الطلاب';
            case 'subjects': return 'المواد';
            case 'attendance': return 'الحضور';
            case 'results': return 'النتائج';
            case 'reports': return 'التقارير';
            default: return tab;
          }
        };

        // render the app
        ReactDOM.render(<EducationCenterApp />, document.getElementById('root'));
    </script>
</body>
</html>